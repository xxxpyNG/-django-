(function(){"use strict";var e={3628:function(e,t,o){var a=o(5130),l=o(6768);function n(e,t){const o=(0,l.g2)("router-view");return(0,l.uX)(),(0,l.Wv)(o)}var r=o(1241);const i={},s=(0,r.A)(i,[["render",n]]);var d=s,u=o(1387),c=o(4232),m=o(144),h=o(4373);const p=e=>((0,l.Qi)("data-v-0ab94c05"),e=e(),(0,l.jt)(),e),f=p((()=>(0,l.Lk)("h3",null,"天气查询",-1)));var g=(0,l.pM)({__name:"ShowCenter",setup(e){const t=[{title:"City",dataIndex:"city",key:"city"},{title:"Weather",dataIndex:"weather",key:"weather"},{title:"Temperature (°C)",dataIndex:"temperature",key:"temperature"},{title:"Humidity (%)",dataIndex:"humidity",key:"humidity"},{title:"Wind Direction",dataIndex:"winddirection",key:"winddirection"},{title:"Wind Power",dataIndex:"windpower",key:"windpower"}],o=(0,m.KR)([]),a=(0,m.KR)(!1),n=(0,m.KR)("130200"),r=(0,l.EW)((()=>({total:o.value.length,current:1,pageSize:o.value.length}))),i=async()=>{if(n.value){a.value=!0;try{const e=`https://restapi.amap.com/v3/weather/weatherInfo?city=${n.value}&key=4cf703d58f4aeeeed5d3b2cb09b01220`,t=await h.A.get(e);if(t.data&&t.data.lives&&t.data.lives.length>0){const e=t.data.lives[0];o.value=[{adcode:e.adcode,city:e.city,weather:e.weather,temperature:e.temperature,humidity:e.humidity,winddirection:e.winddirection,windpower:e.windpower}]}else o.value=[]}catch(e){console.error("请求天气数据时出错:",e)}finally{a.value=!1}}},s=()=>{i()};return(0,l.sV)((()=>{i()})),(e,d)=>{const u=(0,l.g2)("a-input-search"),m=(0,l.g2)("a-col"),h=(0,l.g2)("a-row"),p=(0,l.g2)("a-table");return(0,l.uX)(),(0,l.CE)(l.FK,null,[f,(0,l.bF)(h,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{span:8,offset:6},{default:(0,l.k6)((()=>[(0,l.bF)(u,{value:n.value,"onUpdate:value":d[0]||(d[0]=e=>n.value=e),placeholder:"城市编码  默认唐山","enter-button":"搜索",size:"large",onSearch:i},null,8,["value"])])),_:1})])),_:1}),(0,l.bF)(m,{span:16,offset:3},{default:(0,l.k6)((()=>[(0,l.bF)(p,{columns:t,"row-key":e=>e.adcode,"data-source":o.value,pagination:r.value,loading:a.value,onChange:s},{bodyCell:(0,l.k6)((({column:e,text:t})=>["city"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.eW)((0,c.v_)(t),1)],64)):"weather"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,c.v_)(t),1)],64)):"temperature"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.eW)((0,c.v_)(t)+"°C",1)],64)):"humidity"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:3},[(0,l.eW)((0,c.v_)(t)+"%",1)],64)):"winddirection"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:4},[(0,l.eW)((0,c.v_)(t),1)],64)):"windpower"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:5},[(0,l.eW)((0,c.v_)(t),1)],64)):(0,l.Q3)("",!0)])),_:1},8,["row-key","data-source","pagination","loading"])])),_:1})],64)}}});const b=(0,r.A)(g,[["__scopeId","data-v-0ab94c05"]]);var k=b,y=o.p+"img/login1.f44cb125.jpg";const _=e=>((0,l.Qi)("data-v-6df9c2bc"),e=e(),(0,l.jt)(),e),v={class:"login box"},F=_((()=>(0,l.Lk)("img",{src:y,alt:""},null,-1))),w={class:"login"},C=_((()=>(0,l.Lk)("div",{class:"login-title"},[(0,l.Lk)("p",{class:"hi"},"Hello,Uric!")],-1))),x={class:"login_box"},L=_((()=>(0,l.Lk)("div",{class:"title"},[(0,l.Lk)("span",null,"登录")],-1))),A={class:"inp"},K={class:"rember"};function I(e,t,o,a,n,r){const i=(0,l.g2)("a-input"),s=(0,l.g2)("a-checkbox");return(0,l.uX)(),(0,l.CE)("div",v,[F,(0,l.Lk)("div",w,[C,(0,l.Lk)("div",x,[L,(0,l.Lk)("div",A,[(0,l.bF)(i,{value:n.username,"onUpdate:value":t[0]||(t[0]=e=>n.username=e),type:"text",placeholder:"用户名",class:"user"},null,8,["value"]),(0,l.bF)(i,{value:n.password,"onUpdate:value":t[1]||(t[1]=e=>n.password=e),type:"password",class:"pwd",placeholder:"密码"},null,8,["value"]),(0,l.Lk)("div",K,[(0,l.Lk)("p",null,[(0,l.bF)(s,{checked:n.remember,"onUpdate:checked":t[2]||(t[2]=e=>n.remember=e)},{default:(0,l.k6)((()=>[(0,l.eW)("记住密码")])),_:1},8,["checked"])])]),(0,l.Lk)("button",{class:"login_btn",onClick:t[3]||(t[3]=(...e)=>r.login&&r.login(...e))},"登录")])])])])}o(4114);var E={name:"Login",data(){return{username:"",password:"",remember:!0}},methods:{login(){h.A.post(this.$settings.host+"/users/login/",{username:this.username,password:this.password}).then((e=>{console.log(e.data.token),this.$store.commit("setToken",e.data.token);let t=this;this.$success({title:"Uric系统提示",content:"登陆成功！欢迎回来！",onOk(){t.$router.push("/")}})})).catch((e=>{console.log("err:::",e)}))}}};const W=(0,r.A)(E,[["render",I],["__scopeId","data-v-6df9c2bc"]]);var O=W;const R={class:"logo",style:{"font-style":"italic","text-align":"center","font-size":"20px",color:"#fff",margin:"10px 0","line-height":"50px","font-family":"'Times New Roman'"}},S=(0,l.Lk)("div",{class:"logo"},null,-1),$=(0,l.Lk)("span",null,"Application List",-1);function U(e,t,o,a,n,r){const i=(0,l.g2)("a-switch"),s=(0,l.g2)("desktop-outlined"),d=(0,l.g2)("router-link"),u=(0,l.g2)("a-menu-item"),m=(0,l.g2)("user-outlined"),h=(0,l.g2)("a-sub-menu"),p=(0,l.g2)("a-menu"),f=(0,l.g2)("a-layout-sider"),g=(0,l.g2)("home-outlined"),b=(0,l.g2)("a-breadcrumb-item"),k=(0,l.g2)("a-breadcrumb"),y=(0,l.g2)("a-col"),_=(0,l.g2)("a-button"),v=(0,l.g2)("a-row"),F=(0,l.g2)("a-layout-header"),w=(0,l.g2)("router-view"),C=(0,l.g2)("a-layout-content"),x=(0,l.g2)("a-layout-footer"),L=(0,l.g2)("a-layout");return(0,l.uX)(),(0,l.Wv)(L,{style:{"min-height":"100vh"}},{default:(0,l.k6)((()=>[(0,l.bF)(f,{collapsed:e.collapsed,"onUpdate:collapsed":t[2]||(t[2]=t=>e.collapsed=t),collapsible:""},{default:(0,l.k6)((()=>[(0,l.Lk)("div",R,[(0,l.Lk)("span",null,[(0,l.bF)(i,{checked:e.checked,"onUpdate:checked":t[0]||(t[0]=t=>e.checked=t)},null,8,["checked"]),(0,l.eW)(" DevOps")])]),S,((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.menu_list,(o=>((0,l.uX)(),(0,l.Wv)(p,{selectedKeys:e.selectedKeys,"onUpdate:selectedKeys":t[1]||(t[1]=t=>e.selectedKeys=t),theme:"dark",mode:"inline"},{default:(0,l.k6)((()=>[0===o.children.length?((0,l.uX)(),(0,l.Wv)(u,{key:o.id},{default:(0,l.k6)((()=>[(0,l.bF)(d,{to:o.menu_url},{default:(0,l.k6)((()=>[(0,l.bF)(s),(0,l.Lk)("span",null,(0,c.v_)(o.title),1)])),_:2},1032,["to"])])),_:2},1024)):((0,l.uX)(),(0,l.Wv)(h,{key:o.id},{title:(0,l.k6)((()=>[(0,l.Lk)("span",null,[(0,l.bF)(m),(0,l.Lk)("span",null,(0,c.v_)(o.title),1)])])),default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(o.children,(e=>((0,l.uX)(),(0,l.Wv)(u,{key:e.id},{default:(0,l.k6)((()=>[(0,l.bF)(d,{to:e.menu_url},{default:(0,l.k6)((()=>[(0,l.eW)((0,c.v_)(e.title),1)])),_:2},1032,["to"])])),_:2},1024)))),128))])),_:2},1024))])),_:2},1032,["selectedKeys"])))),256))])),_:1},8,["collapsed"]),(0,l.bF)(L,null,{default:(0,l.k6)((()=>[(0,l.bF)(F,{style:{background:"#fff",padding:"20px"}},{default:(0,l.k6)((()=>[(0,l.bF)(v,{type:"flex",justify:"start"},{default:(0,l.k6)((()=>[(0,l.bF)(y,{span:6},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(b,{href:""},{default:(0,l.k6)((()=>[(0,l.bF)(g)])),_:1}),(0,l.bF)(b,{href:""},{default:(0,l.k6)((()=>[(0,l.bF)(m),$])),_:1}),(0,l.bF)(b,null,{default:(0,l.k6)((()=>[(0,l.eW)("Application")])),_:1})])),_:1})])),_:1}),(0,l.bF)(y,{span:1,offset:17},{default:(0,l.k6)((()=>[(0,l.bF)(k,null,{default:(0,l.k6)((()=>[(0,l.bF)(_,{onClick:e.logout,type:"primary",class:"logout"},{default:(0,l.k6)((()=>[(0,l.eW)(" 注销 ")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.bF)(C,{style:{margin:"0 16px"}},{default:(0,l.k6)((()=>[(0,l.bF)(w)])),_:1}),(0,l.bF)(x,{style:{"text-align":"center"}},{default:(0,l.k6)((()=>[(0,l.eW)(" Ant Design ©2018 Created by Ant UED ")])),_:1})])),_:1})])),_:1})}var X=o(4973),j=o(7953),M=o(6697),V=o(6712),z=o(629),H=o(1043),T=(0,l.pM)({setup(){const e=(0,m.KR)(!0);return{checked:e}},components:{PieChartOutlined:X.A,DesktopOutlined:j.A,UserOutlined:M.A,TeamOutlined:V.A,FileOutlined:z.A,HomeOutlined:H.A},data(){return{collapsed:(0,m.KR)(!1),selectedKeys:(0,m.KR)(["1"]),menu_list:[{id:1,icon:"mail",title:"展示中心",tube:"",menu_url:"/uric/show_center",children:[]},{id:2,icon:"mail",title:"资产管理",menu_url:"/uric/host",children:[]},{id:3,icon:"bold",title:"批量任务",tube:"",menu_url:"/uric/workbench",children:[{id:10,icon:"mail",title:"执行任务",menu_url:"/uric/multi_exec"},{id:11,icon:"mail",title:"命令管理",menu_url:"/uric/template_manage"}]},{id:4,icon:"highlight",title:"代码发布",tube:"",menu_url:"/uric/workbench",children:[{id:12,title:"应用管理",menu_url:"/uric/release"},{id:13,title:"发布申请",menu_url:"/uric/release"}]},{id:5,icon:"mail",title:"定时计划",tube:"",menu_url:"/uric/workbench",children:[]},{id:6,icon:"mail",title:"配置管理",tube:"",menu_url:"/uric/workbench",children:[{id:14,title:"环境管理",menu_url:"/uric/environment"},{id:15,title:"服务配置",menu_url:"/uric/workbench"},{id:16,title:"应用配置",menu_url:"/uric/workbench"}]},{id:7,icon:"mail",title:"监控预警",tube:"",menu_url:"/uric/workbench",children:[]},{id:8,icon:"mail",title:"报警",tube:"",menu_url:"/uric/workbench",children:[{id:17,title:"报警历史",menu_url:"/uric/workbench"},{id:18,title:"报警联系人",menu_url:"/uric/workbench"},{id:19,title:"报警联系组",menu_url:"/uric/workbench"}]},{id:9,icon:"mail",title:"用户管理",tube:"",menu_url:"/uric/workbench",children:[{id:20,title:"账户管理",tube:"",menu_url:"/uric/workbench"},{id:21,title:"角色管理",tube:"",menu_url:"/uric/workbench"},{id:22,title:"系统设置",tube:"",menu_url:"/uric/workbench"}]}]}},methods:{logout(){let e=this;this.$confirm({title:"Uric系统提示",content:"您确认要注销登陆吗？",onOk(){e.$store.commit("setToken",""),e.$router.push("/login")}})}}});const D=(0,r.A)(T,[["render",U]]);var P=D;const q={class:"console"},Q=(0,l.Lk)("div",{id:"terminal"},null,-1),B=[Q];function N(e,t,o,a,n,r){return(0,l.uX)(),(0,l.CE)("div",q,B)}var G=o(2706),J={host:"http://api.urls.cn:8000"},Y={name:"Console",mounted(){this.show_terminal()},methods:{show_terminal(){let e=new G.Terminal({rendererType:"canvas",convertEol:!0,scrollback:100,disableStdin:!1,cursorStyle:"underline",cursorBlink:!0,theme:{foreground:"#ffffff",background:"#060101",cursor:"help"}}),t=new WebSocket(`ws://api.uric.cn:8000/ws/ssh/${this.$route.params.host_id}/`),o="";t.onmessage=function(t){if(o){console.log(JSON.stringify(t.data)),o="";let a=t.data.replace(t.data.split("\r\n",1)[0]+"\r\n","");e.write("\r\n"+a)}else e.write(t.data)},e.prompt=()=>{e.write("\r\n")},e.onKey((a=>{console.log(a.key);const l=a.domEvent,n=!l.altKey&&!l.altGraphKey&&!l.ctrlKey&&!l.metaKey;"Enter"===l.key?t.send(o):"BackSpace"===l.key?e._core.buffer.x>2&&e.write("\b \b"):n&&(e.write(a.key),o+=a.key)})),e.open(document.getElementById("terminal"))}}};const Z=(0,r.A)(Y,[["render",N]]);var ee=Z;const te={class:"multi_exec"},oe=(0,l.Lk)("h3",null,"执行主机：",-1),ae={style:{"margin-top":"10px"}},le={style:{margin:"20px"}},ne={style:{"margin-left":"8px"}},re=(0,l.Lk)("hr",null,null,-1);function ie(e,t,o,a,n,r){const i=(0,l.g2)("a-tag"),s=(0,l.g2)("a-button"),d=(0,l.g2)("a-select"),u=(0,l.g2)("a-form-item"),m=(0,l.g2)("a-col"),h=(0,l.g2)("a-input"),p=(0,l.g2)("a-row"),f=(0,l.g2)("a-table"),g=(0,l.g2)("a-modal"),b=(0,l.g2)("a-select-option"),k=(0,l.g2)("v-ace-editor");return(0,l.uX)(),(0,l.CE)("div",te,[(0,l.Lk)("div",null,[oe,(0,l.Lk)("div",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.show_host_info,((e,t)=>((0,l.uX)(),(0,l.Wv)(i,{closable:"",onClose:e=>r.close_host(t),key:e.id},{default:(0,l.k6)((()=>[(0,l.eW)((0,c.v_)(`${e.name}(${e.ip_addr}:${e.port})`),1)])),_:2},1032,["onClose"])))),128))])]),(0,l.Lk)("div",ae,[(0,l.bF)(s,{onClick:r.showModal,icon:"plus"},{default:(0,l.k6)((()=>[(0,l.eW)("从主机列表中选择")])),_:1},8,["onClick"]),(0,l.eW)("  "),(0,l.bF)(s,{onClick:r.showModal2},{default:(0,l.k6)((()=>[(0,l.eW)("从执行模板中选择")])),_:1},8,["onClick"]),(0,l.Lk)("div",le,[(0,l.bF)(g,{visible:n.visible2,"onUpdate:visible":t[2]||(t[2]=e=>n.visible2=e),title:"选择执行模板",onOk:r.handleOk2,width:"960px"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",null,[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{span:10},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"模板类别：","label-col":n.formItemLayout.labelCol,"wrapper-col":n.formItemLayout.wrapperCol},{default:(0,l.k6)((()=>[(0,l.bF)(d,{style:{width:"160px"},placeholder:"请选择",onChange:t[0]||(t[0]=()=>{})})])),_:1},8,["label-col","wrapper-col"])])),_:1}),(0,l.bF)(m,{span:10},{default:(0,l.k6)((()=>[(0,l.bF)(u,{"label-col":n.formItemLayout.labelCol,"wrapper-col":n.formItemLayout.wrapperCol,label:"模板名称："},{default:(0,l.k6)((()=>[(0,l.bF)(h,{placeholder:"请输入"})])),_:1},8,["label-col","wrapper-col"])])),_:1}),(0,l.bF)(m,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"primary",icon:"sync",style:{"margin-top":"3px"},onClick:t[1]||(t[1]=()=>{})},{default:(0,l.k6)((()=>[(0,l.eW)("刷新")])),_:1})])),_:1})])),_:1})]),(0,l.Lk)("div",null,[(0,l.bF)(f,{columns:n.tem_columns,"data-source":n.tem_data,rowKey:e=>e.id,"row-selection":{radioselectedRow:n.radioselectedRow,onChange:r.onSelectChange2,type:"radio"}},null,8,["columns","data-source","rowKey","row-selection"])])])),_:1},8,["visible","onOk"])]),(0,l.Lk)("div",null,[(0,l.bF)(g,{visible:n.MultiExecVisible,"onUpdate:visible":t[4]||(t[4]=e=>n.MultiExecVisible=e),title:"",onOk:r.onMultiExecSubmit,onCancel:e.excelFormCancel,width:1e3},{default:(0,l.k6)((()=>[(0,l.bF)(p,null,{default:(0,l.k6)((()=>[(0,l.bF)(m,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(u,{label:"主机类别：","label-col":n.formItemLayout.labelCol,"wrapper-col":n.formItemLayout.wrapperCol},{default:(0,l.k6)((()=>[(0,l.bF)(d,{style:{width:"160px"},placeholder:"请选择",modelValue:n.host_form.form.category,"onUpdate:modelValue":t[3]||(t[3]=e=>n.host_form.form.category=e),onChange:r.has_change_category},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.categorys,((e,t)=>((0,l.uX)(),(0,l.Wv)(b,{value:e.id,key:e.id},{default:(0,l.k6)((()=>[(0,l.eW)((0,c.v_)(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1},8,["label-col","wrapper-col"])])),_:1}),(0,l.bF)(m,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(u,{"label-col":n.formItemLayout.labelCol,"wrapper-col":n.formItemLayout.wrapperCol,label:"主机别名："},{default:(0,l.k6)((()=>[(0,l.bF)(h,{placeholder:"请输入"})])),_:1},8,["label-col","wrapper-col"])])),_:1}),(0,l.bF)(m,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(u,{"label-col":n.formItemLayout.labelCol,"wrapper-col":n.formItemLayout.wrapperCol,label:"已选："},{default:(0,l.k6)((()=>[(0,l.Lk)("span",ne,[r.hasSelected?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.eW)((0,c.v_)(`${n.selectedRowKeys.length}`),1)],64)):(0,l.Q3)("",!0)])])),_:1},8,["label-col","wrapper-col"])])),_:1}),(0,l.bF)(m,{span:4},{default:(0,l.k6)((()=>[(0,l.bF)(s,{type:"primary",icon:"sync",style:{"margin-top":"3px"},onClick:r.refresh_data},{default:(0,l.k6)((()=>[(0,l.eW)("刷新")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,l.Lk)("div",null,[(0,l.bF)(f,{columns:n.columns,"data-source":n.data,pagination:!1,rowKey:e=>e.id,"row-selection":{selectedRowKeys:n.selectedRowKeys,onChange:r.onSelectChange}},null,8,["columns","data-source","rowKey","row-selection"])])])),_:1},8,["visible","onOk","onCancel"])])]),(0,l.bF)(k,{value:n.content,"onUpdate:value":t[5]||(t[5]=e=>n.content=e),onInit:e.editorInit,lang:"html",theme:"chrome",style:{height:"200px"}},null,8,["value","onInit"]),(0,l.Lk)("div",null,[(0,l.bF)(s,{type:"primary",icon:"thunderbolt",onClick:r.execute_cmd},{default:(0,l.k6)((()=>[(0,l.eW)("开始执行")])),_:1},8,["onClick"])]),re])}var se=o(2644),de=(o(8873),o(2342),o(782)),ue=(0,de.y$)({state:{},getters:{},mutations:{},actions:{},modules:{}}),ce=o(7694);const me={labelCol:{span:8},wrapperCol:{span:14}},he=[{scopedSlots:{customRender:"action"}},{title:"类别",dataIndex:"category_name",key:"category_name"},{title:"主机名称",dataIndex:"name",key:"name"},{title:"连接地址",dataIndex:"ip_addr",key:"ip_addr",width:200},{title:"端口",dataIndex:"port",key:"port"},{title:"备注信息",dataIndex:"description",key:"description"}],pe=[{title:"模板名称",dataIndex:"name",key:"name"},{title:"模板类型",dataIndex:"category_name",key:"category_name"},{title:"模板内容",dataIndex:"cmd",key:"cmd",width:200},{title:"描述信息",dataIndex:"description",key:"description"}];var fe={name:"MultiExec",data(){return{formItemLayout:me,columns:he,show_host_info:[],MultiExecVisible:!1,host_form:{form:{category:void 0}},data:[],categorys:[],selectedRowKeys:[],selected_host_ids:[],visible2:!1,template_form:{form:{category:void 0}},tem_categorys:[],tem_data:[],radioselectedRow:[],content:"",tem_columns:pe}},computed:{hasSelected(){return this.selectedRowKeys.length>0}},created(){this.get_host_category_list(),this.get_host_list(),this.get_templates_category_list(),this.get_templates_list()},methods:{showModal(){this.MultiExecVisible=!0},onSelectChange(e){this.selectedRowKeys=e},onMultiExecSubmit(){this.data.forEach(((e,t)=>{this.selectedRowKeys.includes(e.id)&&(this.show_host_info.push({id:e.id,name:e.name,ip_addr:e.ip_addr,port:e.port}),this.selected_host_ids.push(e.id))})),this.MultiExecVisible=!1},get_host_category_list(){h.A.get(`${this.$settings.host}/host/category`,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{this.categorys=e.data}))},get_host_list(e=null){let t={};null!==e&&(t.category=e),h.A.get(`${this.$settings.host}/host/`,{params:t,headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{this.data=e.data}))},has_change_category(e){this.get_host_list(e)},refresh_data(){this.host_form.form.category=void 0,this.get_host_list()},close_host(e){this.show_host_info.splice(e,1);let t=this.selected_host_ids.splice(e,1),o=this.selectedRowKeys.indexOf(t[0]);this.selectedRowKeys.splice(o,1)},execute_cmd(){h.A.post(`${this.$settings.host}/mtask/cmd_exec`,{host_ids:this.selected_host_ids,cmd:this.content},{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{console.log(e),ce.Ay.success("批量任务执行成功！")})).catch((e=>{ce.Ay.error("批量任务执行失败！")}))},showModal2(){this.visible2=!0},handleOk2(e){let t=this.radioselectedRow[0];this.tem_data.forEach(((e,o)=>{e.id===t&&(this.content=e.cmd)})),this.visible2=!1},onSelectChange2(e){console.log(">>>>> ",e),this.radioselectedRow=e},handleSelectChange2(e){this.get_templates_list(e)},refresh_data2(){this.get_templates_list()},get_templates_list(e=null){let t={};null!==e&&(t.category=e),h.A.get(`${this.$settings.host}/mtask/templates`,{params:t,headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{this.tem_data=e.data}))},get_templates_category_list(){h.A.get(`${this.$settings.host}/mtask/templates/categorys`,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{this.tem_categorys=e.data}))}},components:{VAceEditor:se.f}};const ge=(0,r.A)(fe,[["render",ie]]);var be=ge;const ke={class:"add_host",style:{margin:"15px"}},ye=(0,l.Lk)("a",null,"Delete",-1),_e=(0,l.Lk)("br",null,null,-1),ve=(0,l.Lk)("a",{download:"主机导入模板.xls"},"主机导入模板.xls",-1),Fe={class:"clearfix"};function we(e,t,o,a,n,r){const i=(0,l.g2)("a-button"),s=(0,l.g2)("a-col"),d=(0,l.g2)("a-row"),u=(0,l.g2)("router-link"),m=(0,l.g2)("a-popconfirm"),h=(0,l.g2)("a-table"),p=(0,l.g2)("a-select-option"),f=(0,l.g2)("a-select"),g=(0,l.g2)("a-form-item"),b=(0,l.g2)("a-input"),k=(0,l.g2)("a-textarea"),y=(0,l.g2)("a-form"),_=(0,l.g2)("a-modal"),v=(0,l.g2)("a-form-model-item"),F=(0,l.g2)("a-form-model"),w=(0,l.g2)("a-alert"),C=(0,l.g2)("upload-outlined"),x=(0,l.g2)("a-upload");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(s,{span:6},{default:(0,l.k6)((()=>[(0,l.Lk)("div",ke,[(0,l.bF)(i,{onClick:a.showHostModal,type:"primary"},{default:(0,l.k6)((()=>[(0,l.eW)(" 新建 ")])),_:1},8,["onClick"]),(0,l.bF)(i,{type:"primary",onClick:a.showExcelModal,style:{"margin-left":"20px"}},{default:(0,l.k6)((()=>[(0,l.eW)(" 批量导入 ")])),_:1},8,["onClick"])])])),_:1})])),_:1}),(0,l.bF)(h,{dataSource:a.hostList.data,columns:a.hostFormColumns},{bodyCell:(0,l.k6)((({column:e,text:t,record:o})=>["console"===e.dataIndex?((0,l.uX)(),(0,l.Wv)(u,{key:0,to:`/uric/console/${o.id}`},{default:(0,l.k6)((()=>[(0,l.eW)("console")])),_:2},1032,["to"])):(0,l.Q3)("",!0),"action"===e.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[a.hostList.data.length?((0,l.uX)(),(0,l.Wv)(m,{key:0,title:"Sure to delete?",onConfirm:e=>a.deleteHost(o)},{default:(0,l.k6)((()=>[ye])),_:2},1032,["onConfirm"])):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0)])),_:1},8,["dataSource","columns"]),(0,l.bF)(_,{visible:a.hostFormVisible,"onUpdate:visible":t[7]||(t[7]=e=>a.hostFormVisible=e),title:"添加主机",onOk:a.onHostFormSubmit,onCancel:t[8]||(t[8]=e=>a.resetForm()),width:800},{default:(0,l.k6)((()=>[(0,l.bF)(y,(0,l.v6)({ref:"formRef",name:"custom-validation",model:a.hostForm.form,rules:a.hostForm.rules},a.layout,{onFinish:a.handleFinish,onValidate:a.handleValidate,onFinishFailed:a.handleFinishFailed}),{default:(0,l.k6)((()=>[(0,l.bF)(g,{label:"主机类别",prop:"zone",name:"category"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(s,{span:12},{default:(0,l.k6)((()=>[(0,l.bF)(f,{ref:"select",value:a.hostForm.form.category,"onUpdate:value":t[0]||(t[0]=e=>a.hostForm.form.category=e),onChange:a.handleCategorySelectChange},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.categoryList.data,(e=>((0,l.uX)(),(0,l.Wv)(p,{value:e.id,key:e.id},{default:(0,l.k6)((()=>[(0,l.eW)((0,c.v_)(e.name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["value","onChange"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(g,{"has-feedback":"",label:"主机名称",name:"name"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{value:a.hostForm.form.name,"onUpdate:value":t[1]||(t[1]=e=>a.hostForm.form.name=e),type:"text",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.bF)(g,{"has-feedback":"",label:"连接地址",name:"username"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(s,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(b,{placeholder:"用户名","addon-before":"ssh",value:a.hostForm.form.username,"onUpdate:value":t[2]||(t[2]=e=>a.hostForm.form.username=e),type:"text",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.bF)(s,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(b,{placeholder:"ip地址","addon-before":"@",value:a.hostForm.form.ip_addr,"onUpdate:value":t[3]||(t[3]=e=>a.hostForm.form.ip_addr=e),type:"text",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.bF)(s,{span:8},{default:(0,l.k6)((()=>[(0,l.bF)(b,{placeholder:"端口号","addon-before":"-p",value:a.hostForm.form.port,"onUpdate:value":t[4]||(t[4]=e=>a.hostForm.form.port=e),type:"text",autocomplete:"off"},null,8,["value"])])),_:1})])),_:1})])),_:1}),(0,l.bF)(g,{"has-feedback":"",label:"连接密码",name:"password"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{value:a.hostForm.form.password,"onUpdate:value":t[5]||(t[5]=e=>a.hostForm.form.password=e),type:"password",autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.bF)(g,{"has-feedback":"",label:"备注信息",name:"remark"},{default:(0,l.k6)((()=>[(0,l.bF)(k,{placeholder:"请输入主机备注信息",value:a.hostForm.form.remark,"onUpdate:value":t[6]||(t[6]=e=>a.hostForm.form.remark=e),type:"text","auto-size":{minRows:3,maxRows:5},autocomplete:"off"},null,8,["value"])])),_:1}),(0,l.bF)(g,{"wrapper-col":{span:14,offset:4}},{default:(0,l.k6)((()=>[(0,l.bF)(i,{onClick:a.resetForm},{default:(0,l.k6)((()=>[(0,l.eW)("Reset")])),_:1},8,["onClick"])])),_:1})])),_:1},16,["model","rules","onFinish","onValidate","onFinishFailed"])])),_:1},8,["visible","onOk"]),(0,l.bF)(_,{width:600,title:"新建主机类别",visible:a.HostCategoryFromVisible,onCancel:a.hostCategoryFormCancel},{footer:(0,l.k6)((()=>[(0,l.bF)(i,{key:"back",onClick:a.hostCategoryFormCancel},{default:(0,l.k6)((()=>[(0,l.eW)("取消")])),_:1},8,["onClick"]),(0,l.bF)(i,{key:"submit",type:"primary",loading:e.loading,onClick:a.onHostCategoryFromSubmit},{default:(0,l.k6)((()=>[(0,l.eW)("提交")])),_:1},8,["loading","onClick"])])),default:(0,l.k6)((()=>[(0,l.bF)(F,{ref:"hostCategoryRuleForm",value:a.hostCategoryForm.form,"onUpdate:value":t[10]||(t[10]=e=>a.hostCategoryForm.form=e),rules:a.hostCategoryForm.rules,"label-col":a.hostCategoryForm.labelCol,"wrapper-col":a.hostCategoryForm.wrapperCol},{default:(0,l.k6)((()=>[(0,l.bF)(v,{ref:"name",label:"类别名称",prop:"name"},{default:(0,l.k6)((()=>[(0,l.bF)(d,null,{default:(0,l.k6)((()=>[(0,l.bF)(s,{span:24},{default:(0,l.k6)((()=>[(0,l.bF)(b,{placeholder:"请输入主机类别名称",value:a.hostCategoryForm.form.name,"onUpdate:value":t[9]||(t[9]=e=>a.hostCategoryForm.form.name=e)},null,8,["value"])])),_:1})])),_:1})])),_:1},512)])),_:1},8,["value","rules","label-col","wrapper-col"])])),_:1},8,["visible","onCancel"]),(0,l.Lk)("div",null,[(0,l.bF)(_,{visible:a.excelVisible,"onUpdate:visible":t[12]||(t[12]=e=>a.excelVisible=e),title:"导入excel批量创建主机",onOk:a.onExcelSubmit,onCancel:a.excelFormCancel,width:800},{default:(0,l.k6)((()=>[(0,l.bF)(w,{type:"info",message:"导入或输入的密码仅作首次验证使用，并不会存储密码。",banner:"",closable:""}),_e,(0,l.Lk)("p",null,[(0,l.bF)(g,{"has-feedback":"",label:"模板下载",help:"请下载使用该模板填充数据后导入"},{default:(0,l.k6)((()=>[ve])),_:1})]),(0,l.Lk)("p",null,[(0,l.bF)(g,{label:"默认密码",help:"如果Excel中密码为空则使用该密码"},{default:(0,l.k6)((()=>[(0,l.bF)(b,{value:a.default_password,"onUpdate:value":t[11]||(t[11]=e=>a.default_password=e),placeholder:"请输入默认主机密码",type:"password"},null,8,["value"])])),_:1})]),(0,l.bF)(g,{label:"导入数据"},{default:(0,l.k6)((()=>[(0,l.Lk)("div",Fe,[(0,l.bF)(x,{"file-list":a.fileList,name:"file","before-upload":a.beforeUpload},{default:(0,l.k6)((()=>[(0,l.bF)(i,null,{default:(0,l.k6)((()=>[(0,l.bF)(C),(0,l.eW)(" Click to Upload ")])),_:1})])),_:1},8,["file-list","before-upload"])])])),_:1})])),_:1},8,["visible","onOk","onCancel"])])],64)}var Ce=o(9735),xe={components:{UploadOutlined:Ce.A},setup(){const e=e=>{console.log(e)},t=(0,m.KR)(),o=(0,m.KR)(!1),a=(0,m.KR)(""),l=(0,m.Kh)({data:[]}),n=(0,m.Kh)({data:[]}),r=(0,m.Kh)({labelCol:{span:6},wrapperCol:{span:14},other:"",form:{name:"",category:"",ip_addr:"",username:"",port:"",remark:"",password:""},rules:{name:[{required:!0,message:"请输入主机名称",trigger:"blur"},{min:3,max:30,message:"长度在3-10位之间",trigger:"blur"}],password:[{required:!0,message:"请输入连接密码",trigger:"blur"},{min:3,max:30,message:"长度在3-10位之间",trigger:"blur"}],category:[{required:!0,message:"请选择类别",trigger:"change"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:30,message:"长度在3-10位",trigger:"blur"}],ip_addr:[{required:!0,message:"请输入连接地址",trigger:"blur"},{max:30,message:"长度最大15位",trigger:"blur"}],port:[{required:!0,message:"请输入端口号",trigger:"blur"},{max:5,message:"长度最大5位",trigger:"blur"}]}});let i=async(e,t)=>""===t?Promise.reject("请输入类别名称"):Promise.resolve();const s=(0,m.Kh)({labelCol:{span:6},wrapperCol:{span:14},other:"",form:{name:""},rules:{name:[{required:!0,message:"请输入类别名称",validator:i,trigger:"blur"},{min:3,max:10,message:"长度在3-10位之间",trigger:"blur"}]}}),d={labelCol:{span:4},wrapperCol:{span:14}},u=e=>{console.log(e,r)},c=e=>{console.log(e)},p=()=>{t.value.resetFields()},f=(...e)=>{console.log(e)},g=(0,m.KR)(!1),b=(0,m.KR)(!1),k=()=>{g.value=!0},y=()=>{const e=new FormData;for(let t in r.form)e.append(t,r.form[t]);h.A.post(`${J.host}/host/`,e,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{console.log("response>>>",e),l.data.unshift(e.data),p(),g.value=!1,ce.Ay.success("成功添加主机信息！")})).catch((e=>{ce.Ay.error("添加主机失败")}))},_=e=>{console.log(e),h.A.delete(`${J.host}/host/${e.id}`,{headers:{Authorization:"jwt "+ue.getters.token}}).then((t=>{let o=l.data.indexOf(e);l.data.splice(o,1)})).catch((e=>{ce.Ay.error("删除主机失败！")}))},v=()=>{o.value=!0},F=()=>{s.form.name="",o.value=!1},w=()=>{b.value=!1},C=()=>{h.A.post(`${J.host}/host/category`,s.form,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{ce.Ay.success({content:"创建主机类别成功!",duration:1}).then((()=>{console.log("response:::",e),n.data.unshift(e.data),F()}))}))},x=()=>{h.A.get(`${J.host}/host`,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{l.data=e.data})).catch((e=>{ce.Ay.error("无法获取主机类别列表信息！")}))},L=()=>{h.A.get(`${J.host}/host/category`,{headers:{Authorization:"jwt "+ue.getters.token}}).then((e=>{n.data=e.data})).catch((e=>{ce.Ay.error("无法获取主机类别列表信息！")}))};x(),L();const A=()=>{b.value=!0},K=e=>{"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?ce.Ay.success(`${e.file.name} file uploaded successfully`):"error"===e.file.status&&ce.Ay.error(`${e.file.name} file upload failed.`)},I=(0,m.KR)([]),E=e=>(I.value=[...I.value,e],!1),W=()=>{const e=new FormData;console.log("fileList.value:",I.value),I.value.forEach((t=>{console.log(">>>",t),e.append("host_excel",t)})),h.A.post(`${J.host}/host/excel_host`,e,{headers:{Authorization:"jwt "+ue.getters.token,"Content-Type":"multipart/form-data"}}).then((e=>{console.log("response:::",e),console.log("hostList:::",l),w(),I.value=[],l.data.push(...e.data.data),ce.Ay.success("批量创建主机成功!！")})).catch((e=>{ce.Ay.error(e.data.message)}))};return{beforeUpload:E,onExcelSubmit:W,selectHostCategory:(0,m.KR)("yuan"),hostForm:r,formRef:t,layout:d,HostCategoryFromVisible:o,handleCategorySelectChange:e,handleFinishFailed:c,handleFinish:u,resetForm:p,handleValidate:f,hostFormVisible:g,excelVisible:b,showHostModal:k,onHostFormSubmit:y,deleteHost:_,showHostCategoryFormModal:v,hostCategoryForm:s,hostCategoryFormCancel:F,excelFormCancel:w,onHostCategoryFromSubmit:C,showExcelModal:A,default_password:a,fileList:I,headers:{authorization:"authorization-text"},handleChange:K,hostFormColumns:[{title:"类别",dataIndex:"category_name",key:"category_name"},{title:"主机名称",dataIndex:"name",key:"name",sorter:!0,width:230},{title:"连接地址",dataIndex:"ip_addr",key:"ip_addr",ellipsis:!0,sorter:!0,width:150},{title:"端口",dataIndex:"port",key:"port",ellipsis:!0},{title:"Console",dataIndex:"console",key:"console",ellipsis:!0},{title:"操作",key:"action",width:200,dataIndex:"action",scopedSlots:{customRender:"action"}}],hostList:l,categoryList:n}}};const Le=(0,r.A)(xe,[["render",we]]);var Ae=Le;const Ke=[{path:"/uric",alias:"/",name:"Base",component:P,children:[{meta:{title:"展示中心",authenticate:!1},path:"show_center",alias:"",name:"ShowCenter",component:k},{meta:{title:"资产管理",authenticate:!0},path:"host",name:"Host",component:Ae},{meta:{title:"Console",authenticate:!0},path:"console/:host_id",name:"Console",component:ee},{path:"multi_exec",name:"MultiExec",component:be}]},{meta:{title:"账户登陆",authenticate:!1},path:"/login",name:"Login",component:O}],Ie=(0,u.aE)({history:(0,u.LA)("/"),routes:Ke});Ie.beforeEach(((e,t,o)=>{document.title=e.meta.title,e.meta.authenticate&&""===ue.getters.token?o({name:"Login"}):o()}));var Ee=Ie,We=o(4711);o(4529);const Oe=(0,a.Ef)(d);(0,a.Ef)(d).use(ue).use(We.Ay).use(Ee).mount("#app"),Oe.config.globalProperties.$settings=J}},t={};function o(a){var l=t[a];if(void 0!==l)return l.exports;var n=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=e,function(){o.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){var e=[];o.O=function(t,a,l,n){if(!a){var r=1/0;for(u=0;u<e.length;u++){a=e[u][0],l=e[u][1],n=e[u][2];for(var i=!0,s=0;s<a.length;s++)(!1&n||r>=n)&&Object.keys(o.O).every((function(e){return o.O[e](a[s])}))?a.splice(s--,1):(i=!1,n<r&&(r=n));if(i){e.splice(u--,1);var d=l();void 0!==d&&(t=d)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[a,l,n]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var a in t)o.o(t,a)&&!o.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){o.p="/"}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,a){var l,n,r=a[0],i=a[1],s=a[2],d=0;if(r.some((function(t){return 0!==e[t]}))){for(l in i)o.o(i,l)&&(o.m[l]=i[l]);if(s)var u=s(o)}for(t&&t(a);d<r.length;d++)n=r[d],o.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return o.O(u)},a=self["webpackChunkweb"]=self["webpackChunkweb"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=o.O(void 0,[504],(function(){return o(3628)}));a=o.O(a)})();
//# sourceMappingURL=app.a1909ce2.js.map